# go语言结构体

go中通过用自定义的方式形成新的类型,结构体是类型中待遇成员的复合类型。通过使用结构体和结构体成员来描述真实世界的实体和实体对应的各种属性。

go中的类型可以被实例化,使用new或者&构造的类型实例的类型是类型的指针。

结构体成员是有一系列的成员变量(字段)构成,字段有一下特性:

- 字段拥有自己的类型和值
- 字段名必须唯一
- 字段的类型也可以是结构体,甚至是字段所在的结构体类型

------

###### 结构体定义

1. 使用关键字type声明自定义类型,结构体是一种复合的基本类型。

   ```go
   type Struct_Name struct{
   	field1 type1
   	...
   }
   ```

2. 结构体各部分说明

   - Struct_Name:结构体的名称,同一个包中不能重复
   - Field1:字段名称必须唯一
   - Type1:字段的基本类型。

###### 实例化结构体-为结构体分配内存并初始化

结构体的定义只是一种内存布局的描述，只有当结构体实例化时，才会真正地分配内存，因此必须在定义结构体并实例化后才能使用结构体的字段。 

根据结构体定义的格式创建一份与格式一致的内存区域，结构体实例与实例间的内存是完全独立的。

1. 基本的实例化形式

   ```go
   var name Struct_name
   ```

   - 使用`.`来访问结构体的成员变量
   - 结构体成员变量的赋值方法与普通变量一致

2. 创建指针类型的结构体

   ```
   name:=new(Struct_name)
   //Struct_name类型被实例化后保存到name变量中，name的类型为*Struct_name，属于指针
   ```

   

3. 取结构体的地址实例化

   - 对结构体进行`&`取地址操作时，视为对该类型进行一次 new 的实例化操作

     ```
     name:=&Struct_name{}
     ```

###### 初始化结构体的成员变量

结构体在实例化时可以直接对成员变量进行初始化，初始化有两种形式分别是以字段“键值对”形式和多个值的列表形式，键值对形式的初始化适合选择性填充字段较多的结构体，多个值的列表形式适合填充字段较少的结构体

1. 字段“键值对”形式初始化结构体
   - 结构体成员中只能包含结构体的指针类型，包含非指针类型会引起编译错误。
2. 多个值的列表形式初始化结构体
   - 必须初始化结构体的所有字段。
   - 每一个初始值的填充顺序必须与字段在结构体中的声明顺序一致。
   - 键值对与值列表的初始化形式不能混用。
3. 初始化匿名结构体
   - 匿名结构体没有类型名称，无须通过 type 关键字定义就可以直接使用
   - 匿名结构体的类型名是结构体包含字段成员的详细描述，匿名结构体在使用时需要重新定义，造成大量重复的代码，因此开发中较少使用

###### 构造函数

Go语言中没有提供构造函数相关的特殊机制，用户根据自己的需求，将参数使用函数传递到结构体构造参数中即可完成构造函数的任务。

###### 类型内嵌和结构体内嵌

结构体可以包含一个或多个匿名（或内嵌）字段，即这些字段没有显式的名字，只有字段的类型是必须的，此时类型也就是字段的名字。匿名字段本身可以是一个结构体类型，即结构体可以包含内嵌结构体。

- 内嵌的结构体可以直接访问其成员变量

- 内嵌结构体的字段名是它的类型名

  ```go
  type A struct {
      ax, ay int
  }
  type B struct {
      A
      bx, by float32
  }
  ```

Practise:

Go语言方法和接收器

为任意类型添加方法

使用时间系统实现事件的响应和处理

结构体内嵌模拟类的继承

使用匿名结构体解析json数据

将结构体数据保存为json数据

